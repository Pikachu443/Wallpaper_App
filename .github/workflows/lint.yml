name: Lint
on: push
jobs:
  lint:
    name: Lint
    runs-on: windows-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v2

      - name: Download Resource Hacker
        run: |
          powershell -Command "Invoke-WebRequest -Uri https://www.angusj.com/resourcehacker/resource_hacker.zip -OutFile resource_hacker.zip"
          powershell -Command "Expand-Archive -Path resource_hacker.zip -DestinationPath ./resource_hacker"

      - name: Compile resource script
        run: |
          powershell -Command "./resource_hacker/ResourceHacker.exe -compile versioninfo.rc -save versioninfo.res"

      - name: Update executable
        run: |
          powershell -Command "./resource_hacker/ResourceHacker.exe -open percy.exe -save percy.exe -action addoverwrite -res versioninfo.res"
          powershell -Command "./resource_hacker/ResourceHacker.exe -open percy.exe -save percy.exe -action addoverwrite -mask ICONGROUP,MAINICON -res icon.ico"
      - name: Upload win artifact
        uses: actions/upload-artifact@v4
        with:
          name: percy.exe
          path: percy.exe
